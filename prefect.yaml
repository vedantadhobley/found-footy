name: found-footy
prefect-version: 3.0.0

build: null
push: null
pull: null

deployments:
  # 1. Independent Daily Ingest
  - name: fixtures-ingest-daily
    entrypoint: found_footy.flows.fixtures_flows:fixtures_ingest_flow
    work_pool:
      name: fixtures-pool
    schedule:
      cron: "5 0 * * *"
      timezone: UTC
      active: false
    parameters:
      date_str: null
      team_ids: null
    tags:
      - fixtures
      - ingest
      - daily
    description: "Daily fixtures ingest with auto-scheduling"

  # 2. Independent Manual Ingest
  - name: fixtures-ingest-manual
    entrypoint: found_footy.flows.fixtures_flows:fixtures_ingest_flow
    work_pool:
      name: fixtures-pool
    parameters:
      date_str: "20250902"
      team_ids: null
    tags:
      - fixtures
      - ingest
      - manual
    description: "Manual fixtures ingest (customizable date/teams)"

  # 3. Universal Fixtures Advance Flow
  - name: fixtures-advance-flow
    entrypoint: found_footy.flows.fixtures_flows:fixtures_advance_flow
    work_pool:
      name: fixtures-pool
    parameters:
      source_collection: "fixtures_staging"      # ✅ NEW: Configurable
      destination_collection: "fixtures_active"  # ✅ NEW: Configurable  
      fixture_id: 0                             # ✅ Will be overridden when scheduled
    tags:
      - fixtures
      - advance
      - universal
    description: "Universal fixture advancement - configurable source/destination"

  # 4. Fixtures Monitor Flow - Always Running
  - name: fixtures-monitor-flow
    entrypoint: found_footy.flows.fixtures_flows:fixtures_monitor_flow
    work_pool:
      name: fixtures-pool
    schedule:
      cron: "*/3 * * * *"  # Every 3 minutes
      timezone: UTC
      active: true  # ✅ ALWAYS ACTIVE - Never stops
    parameters: {}
    tags:
      - fixtures
      - monitor
      - always-running
    description: "Always-running monitor - checks every 3 minutes, skips work when no active fixtures"

  # 5. Twitter Search Flow
  - name: twitter-search-flow
    entrypoint: found_footy.flows.twitter_flows:twitter_search_flow
    work_pool:
      name: twitter-pool
    parameters:
      goal_id: null
    tags:
      - twitter
      - search
      - automation
    description: "First step of Twitter process - search and process individual goals"